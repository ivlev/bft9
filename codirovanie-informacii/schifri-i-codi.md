# Шифры и коды: от простого к сложному

В школьном курсе вскользь даётся криптография: она начинается и заканчивается простыми подстановочными шифрами, с которых несколько тысяч лет назад начиналась эпоха примитивного сокрытия информации.

Для решения задач ОГЭ достаточно использовать **три** простейших принципа:

1. > анализ аномалий, который определяет какой симвоол не может быть ни чем иным, ктороме как одним из известных;  
   > частотный анализ, опрееляющий вхождение в текст наиболее часто встречающихся в европейских языках букв - обчно это гласные: А, О, И, Е;  
   > восстановление текста просходит вокруг обнаруженных неизменных или частотных аномалий.

Для дальнейшего самостоятельного погружения в криптографию и криптоанализ рекомендую найти и прочитать книгу **Дэвида Кака "Взломщики кодов**".

### Дэвид Кан

\( фрагмент для ознакомления \)

# Взломщики кодов

#### Предисловие

Дешифрование является одним из наиболее важных способов добывания разведывательных данных в современном мире. Оно дает намного больше достоверной информации, чем традиционная агентурная разведка, оказывая значительное влияние на политику правительств. Тем не менее у дешифровальных спецслужб нет своего летописца.

А они остро нуждаются в таком летописце. Хотя официально было признано, что американские дешифровальщики сократили сроки окончания войны на Тихом океане примерно на год, в научных трудах по истории это отражено лишь мимоходом, что приводит к неправильному взгляду на ход исторических событий в мире. Более того, криптоанализ сам может только выиграть, как и другие области человеческой деятельности, зная своих гениев и основные направления развития, свои ошибки и извлеченные из них уроки.

Я сделал попытку написать серьезную историю криптоанализа, и в первую очередь – разъяснить обществу ту важную роль, которую дешифрование сыграло в жизни человечества. Для любознательных читателей эта книга может послужить надежным проводником в прошлое криптоанализа. А для историков она будет полезна тем, что обратит их внимание на скрытое влияние дешифрования на историю.

Начиная эту книгу, я, подобно другим, хорошо осведомленным криптологам-любителям, считал, будто знаю обо всем, что напечатано по криптоанализу. Но как же мало нам было известно! Ни мы, любители, ни даже профессионалы не имели представления о том, какое большое количество ценной информации содержится в научных журналах. Мы не обращались к дешифровальщикам с просьбой поделиться своими воспоминаниями. Мы не пытались воспользоваться огромным богатством архивов. Мы не пробовали изучать вопросы, которые в настоящее время представляются нам главными. Я думаю, что не ошибусь, если заявлю, что по сравнению с ранее опубликованными материалами в моем труде содержится от 85 до 90% совершенно нового.

И это далеко не все. Из-за необоснованной секретности недоступна большая часть документов, относящихся к недавнему прошлому. Чтобы рассказать о криптоаналитических разработках этого периода полностью, потребуется еще одна такая же книга. Даже, к примеру, в XVIII веке можно обнаружить массу неизученных рукописей.

В моей книге я старался придерживаться двух принципов. Первый – по возможности использовать первоисточники. Часто я не мог поступить иначе, так как по некоторым вопросам еще ничего не было опубликовано. Второй – при оценке роли криптоанализа, будь то на поле брани или на дипломатическом поприще, я пытался никогда не забывать об иных важных факторах, сыгравших свою роль. Если книга создает впечатление, что все события в истории зависели от тех, о ком написана эта книга, то это не история, а ее искажение. Такой подход особенно широко распространен в литературе о шпионах, но от него не застрахован и криптоанализ. Я считаю, что хотя и пытаюсь уравновесить рассказ об истории дешифрования упоминанием других факторов, тем самым я не уменьшаю интереса к книге. Просто мое повествование становится от этого достовернее и поэтому заслуживает более серьезного внимания.

У каждой профессии есть свой словарь. Словарь криптоаналитика достаточно сложен, поэтому небольшое по объему введение в общепринятую криптоаналитическую терминологию значительно облегчит понимание изложенного в этой книге. Определения в нем являются нестрогими и преследуют лишь цель пояснения того или иного термина. Исключения игнорируются, а множество редко употребляемых терминов и вовсе не определены – в процессе чтения книги их значение становится ясным из контекста.

_Открытый текст_– сообщение, подлежащее засекречиванию. В результате применения методов_шифрования_сообщение делают непонятным для посторонних, используя два основных способа преобразования открытого текста.

В случае_перестановки_знаки открытого текста перемешиваются, нарушается их нормальный порядок следования. Перетасовать буквы слова_«секрет»_так, чтобы получить_«еткрсе»,_и означает сделать перестановку.

При_замене_знаки открытого текста замещаются другими знаками. Так, слово_«секрет»_может быть заменено на_19 5 3 18520._

Системы замены основаны на идее_шифралфавита_– перечня эквивалентов, используемых для преобразования открытого текста в шифрованный.

Иногда шифралфавит предусматривает несколько замен одного знака. Например, знак открытого текста «с» не всегда замещается числом_16,_а может быть заменен одним из чисел_16, 21, 35, 74._Этот выбор называется_гомофоном._Время от времени в шифралфавит включаются символы, которые ничего не означают. Такие символы зовут_пустышками._

В том случае, когда используется только один шифралфавит, система замены называется_одноалфавитной._Но когда применяются два или большее число шифралфавитов по какому-то заранее определенному правилу, система замены становится_многоалфавитной._

Среди систем замены следует делать различия между_кодами_и_шифрами._Код состоит из тысяч слов, фраз, букв и слогов и соответствующих им_кодовых слов_или_кодовых обозначений,_которые заменяют эти элементы открытого текста. По существу, код является огромным шифром замены, в котором основными единицами открытого текста служат слова и фразы. В шифрах же основная единица – это знак, иногда пара знаков.

В течение 450 лет, начиная примерно с 1400 г. и до 1850 г., в шифровальной практике доминировали системы, которые являлись наполовину кодом и наполовину шифром. В них обычно был отдельный шифралфавит, включавший гомофоны и кодоподобный перечень имен, слов и слогов. От этого перечня, первоначально состоявшего только из имен, и произошло название для таких систем –_номенклатор._

Во многих шифрах используется_ключ,_который определяет порядок следования знаков в шифралфавите, или порядок перемешивания знаков в перестановке, или начальные установки в шифрмашинах. Когда слово, или фраза, или число служат ключом, они, естественно, называются_ключевым словом, ключевой фразой_или_ключевым числом._

Проведение соответствующих преобразований открытого текста в шифрованный называется_шифрованием_или_кодированием_открытого текста. То, что получается в результате, носит название_шифртекста_или_кодтекста._

Окончательно обработанное и отосланное секретное сообщение называется_криптограммой._Термин «шифртекст» обращает внимание на результат зашифрования, в то время как термин «криптограмма» подчеркивает сам факт передачи сообщения и является аналогом слова «телеграмма».

_Расшифрование \(раскодирование\)_означает проведение обратных преобразований шифртекста \(кодтекста\) лицами, владеющими на законном основании ключом и системой шифрования \(кодирования\), для получения открытого текста. Этот процесс следует отличать от_криптоанализа,_который ставит своей целью прочтение открытого текста \(или, другими словами,_дешифрование\)_криптограммы людьми, не имеющими в своем распоряжении ни ключа, ни системы, то есть лицами, являющимися третьей стороной, «противником». Разница между ними, безусловно, огромная, хотя начиная с того времени, когда возникло слово «криптоанализ», термины «расшифровать» или «раскодировать» часто использовались и в смысле «дешифровать».

Успешный криптоанализ шифра или кода часто именуют его_вскрытием_или_взломом._

Сообщения, посылаемые без предварительного зашифрования, называются_незашифрованными_или отправляемыми_клером._Иногда говорят еще, что они передаются_открытым текстом._

Наконец, _криптология_– это наука, охватывающая составление шифров_\(криптографию\)_и криптоанализ.

#### Подъем на Западе

Западноевропейская цивилизация начала использовать криптографию с тех самых пор, как возникла из недр средневекового феодализма. Правда, первоначально тайнопись находилась в эмбриональном состоянии, ее применение было редким и непостоянным. Даже церковные системы шифрования пребывали в зачаточном виде, хотя тогда Церковь пользовалась наибольшим влиянием в обществе. Все же именно с этого времени криптография развивается без продолжительных периодов стагнации и регресса, ее совершенствование становится неуклонным.

Самый древний шифрованный документ, хранящийся в архивах Ватикана, представляет собой небольшой список имен, составленный в 1326-1327 гг., когда в Италии шла борьба между гвельфами[\[2\]]()и гибеллинами[3](http://www.e-reading.club/bookreader.php/25249/Kan_-_Vzlomshchiki_kodov.html#_edn3). В нем гибеллины называются «египтянами», а гвельфы – «детьми Израилевыми». В архивах Венеции можно отыскать шифр, датируемый 1226 г. Суть его заключается в том, что точки и кресты заменяют гласные в нескольких словах, находящихся в разных местах послания.

В 1379 г. антипапа Климентий VII, за год до этого бежавший во французский город Авиньон, чтобы внести раскол в Римскую Католическую Церковь, объявив себя законным владельцем папского трона, повелел своей канцелярии ввести в действие новые шифры. Секретарь антипапы Габриэли Лавинде, работавший в его представительстве в одном из североитальянских городов-государств, изготовил индивидуальные ключи для всех 24 корреспондентов антипапы. Ключи Лавинде, самые древние среди сохранившихся на Западе, сочетают в себе элементы кода и шифра. Помимо шифралфавита замены с пустышками, почти каждый такой ключ включает небольшой список из более десятка широко распространенных слов или имен, которым ставятся в соответствие двухбуквенные кодовые эквиваленты. Это самый ранний образец номенклатора – гибридной системы шифрования, которой в последующие 450 лет суждено было распространиться по всей Европе.

Сначала западные шифралфавиты предусматривали только однозначную замену каждой буквы открытого текста. Первый известный Западу случай многозначной замены имел место в шифре, который был изобретен в 1401 г. в Мантуанском герцогстве. Секретарь герцога ввел в шифр гомофоны для гласных букв, чтобы создать препятствия для любого человека, который попытался бы дешифровать перехваченное сообщение. Тот факт, что гомофоны применялись не для всех букв, а только по отношению к гласным, свидетельствует о знании криптоаналитических методов, основанных на частоте встречаемости знаков шифртекста.

Откуда взялись эти познания? Возможно, они самостоятельно родились в Западной Европе. Хотя верно и то, что соприкосновение с мусульманской цивилизацией во время крестовых походов вызвало на Западе бурное развитие естественных наук и что арабские математические трактаты нередко попадали в Европу через Испанию. Однако нет никаких документальных доказательств того, что криптоанализ попал в христианский мир из исламского. У арабов криптоанализ считался скорее разделом грамматики, чем частью естественных наук или математики, поскольку по традиции был тесно связан с языком Корана. Во всяком случае, труды Калкашанди, в которых давалось подробное объяснение методов дешифрования, так и не были переведены с арабского на европейские языки.

Развитие криптоанализа на Западе оказалось в прямой зависимости от расцвета дипломатии. С тех пор как государства стали поддерживать постоянные дипломатические отношения друг с другом, их послы, которых иногда иронично называли «почетными шпионами», регулярно отправляли к себе на родину пространные послания. Существовавшие между государствами соперничество и подозрительность вынуждали дипломатов зашифровывать свои депеши, поскольку их нередко перехватывали и вскрывали. К концу XVI столетия криптоанализ стал играть настолько важную роль, что в большинстве европейских государств были введены должности секретарей по шифрам, которые полный рабочий день были заняты зашифрованием и расшифрованием сообщений, а также дешифрованием перехваченных депеш.

Первым знаменитым западным криптоаналитиком стал венецианец Джованни Соро, в 1506 г. назначенный секретарем по шифрам Венецианской республики. Он прославился тем, что с успехом вскрывал шифры многочисленных европейских княжеств. Слава Соро была столь велика, что начиная с 1510 г папская курия присылала ему для вскрытия шифры, с которыми не могли справиться в Риме. В 1526 г. Папа Климентий VII[4](http://www.e-reading.club/bookreader.php/25249/Kan_-_Vzlomshchiki_kodov.html#_edn4)дважды направлял Соро перехваченные депеши для дешифрования, и оба раза Соро добился успеха. А когда одно из посланий Климентия попало в руки его противников, тот воскликнул: «Соро может вскрыть любой шифр!» – и направил Соро копию этого послания, чтобы выяснить, надежно ли оно зашифровано. Климентий успокоился, только когда Соро сообщил, что не может его прочесть. Хотя кто знает, не пытался ли Соро преднамеренно ввести Папу в заблуждение ложными заявлениями о надежности его шифра.

В 1542 г. Соро получил двух помощников. С этого времени Венеция имела уже трех квалифицированных криптоаналитиков. Их помещение находилось во дворце венецианского правителя, где они работали за запертыми дверями. Никому не дозволялось их беспокоить, а им самим, по слухам, не разрешалось покидать свое рабочее помещение, пока не будет найден открытый текст очередной перехваченной криптограммы. Криптоаналитики также писали трактаты, в которых разъясняли методы своей работы. Труд Соро о дешифровании переписки на латинском, итальянском, испанском и французском языках, написанный им в начале XVI века, утерян. Но уцелели отрывочные записи его преемника, а также исследования в этой области других венецианских секретарей по шифрам.

Венеция была не единственным местом обитания искусных криптоаналитиков в эпоху европейского Возрождения. Римский Папа Павел III, сменивший Климентия VII, быстро сообразил, что не в его интересах посылать шифры для вскрытия за границу. В 1555 г. в папской курии была учреждена должность секретаря по шифрам. Первый успех пришел только через два года – в 1557 г. папские криптоаналитики вскрыли шифр испанского короля Филиппа II, который тогда воевал с Папой Римским. А в 1567 г. отличился викарий собора Святого Петра в Риме, который менее чем за шесть часов сумел прочитать криптограмму, написанную «на большом листе бумаги на турецком языке, на котором викарий не знал и четырех слов».

Во Флоренции Пирро Музефили, граф Сассетский, с 1546-го по 1557 г. прочел множество шифрованных сообщений, вскрыв среди прочих номенклаторы, использовавшиеся в переписке между французским королем Генрихом II и его послом в Дании. Криптоаналитическая экспертиза Музефили была настолько квалифицированной, что многие приезжали к нему, как и к Соро, с просьбой вскрыть для них шифры. Среди клиентов Музефили был и король Англии, который прислал ему криптограмму, найденную в подметках пары золотых туфель, доставленных к его двору из Франции.

Жестокие и решительные герцоги Сфорца, правители Милана, также широко пользовались услугами криптоаналитиков. В 1474 г. один из секретарей Сфорца по имени Чикко Симонетта написал первый в мире трактат, посвященный исключительно криптоанализу. В нем Симонетта установил 13 правил вскрытия шифров простой замены, в которых сохранены разделители слов. Рукопись, написанная на трех кусках пергамента, начинается со слов:

«Первое необходимое условие состоит в выяснении того, написан ли документ на латинском или на местном языке, а это можно установить следующим образом: выясните, имеют ли слова в данном документе только пять различных окончаний, меньше или больше. Если их только пять или меньше, вы правы, считая, что документ написан на местном языке…»

В XVI веке не только итальянские дворы славились своими криптоаналитиками. Во Франции в дешифровании перехваченных депеш наиболее преуспел Филибер Бабу, занимавший пост первого государственного секретаря при короле Франциске I. Один наблюдатель описывает, как Бабу, «не имея алфавита, часто дешифровывал многие перехваченные депеши на испанском, итальянском и немецком языках, хотя он не знал ни одного из этих языков или знал очень плохо[5](http://www.e-reading.club/bookreader.php/25249/Kan_-_Vzlomshchiki_kodov.html#_edn5), причем он упорно работал над сообщением дни и ночи напролет в течение трех недель, прежде чем разгадывал одно слово. После того как брешь была проделана, остальное происходило очень быстро и напоминало разрушение стен». Следует заметить, что в то время как Бабу не покладая рук работал на короля, король с удовольствием принимал у себя любовницу – прелестную жену Бабу. Бабу получил много милостей от короля, но трудно сказать, за что он их удостоился – за криптоаналитические ли успехи или за позволение наставлять рога.

В 1589 г. королем Франции стал Генрих IV, который сразу же был вынужден вступить в ожесточенную борьбу со Священной лигой – фракцией католиков, которые наотрез отказывались согласиться с тем, что протестант может носить европейскую корону. Священная лига во главе с герцогом Майеннским контролировала столицу и все другие крупные города Франции, получая большие подкрепления в виде живой силы и денег от испанского короля Филиппа II. Генрих был со всех сторон окружен противником. Но именно в это тяжелое для него время в его руки попала часть переписки Филиппа с испанским военачальником Хуаном Морео.

Письма Филиппа были зашифрованы, но у Генриха в то время работал некий Франсуа Виет, 49-летний адвокат, член тайного совета короля. В течение многих лет любимым развлечением Виета была математика. В наши дни Виета помнят как человека, которому обязана своим происхождением современная алгебра. В 1588 г. он прочел шифрованную испанскую депешу, адресованную Алессандро Фарнезе, герцогу Пармы, который командовал испанскими войсками Священной лиги. С тех пор Генрих передавал Виету все новые перехваченные депеши, чтобы выяснить, сможет ли он повторить свой успех.

Очередной крупный успех пришел к Виету только 15 марта 1590 г. В этот день он отправил королю Генриху полностью дешифрованное письмо Морео Филиппу II, которое содержало подробности переговоров Морео с герцогом Майеннским. Письмо было зашифровано с помощью нового номенклатора, который Филипп специально дал Морео перед его отъездом во Францию. Но Виет не знал, что за день до этого Генрих разбил превосходящие силы герцога в битве при реке Иври, к западу от Парижа, придав несколько упражненческий характер задаче дешифрования письма Морео.

Тем не менее в письме Генриху, которое содержало открытый текст шифрованной депеши Морео, Виет, в частности, хвастливо написал:

«Не волнуйтесь из-за того, что для Ваших врагов это будет повод сменить свои шифры и еще больше замаскироваться. Они неоднократно меняли их, и тем не менее их уловки были и всегда будут раскрыты».

Из-за этой своей самонадеянности Виет однажды и попал в ловушку, благодаря которой один зарубежный дипломат выудил из Виета конфиденциальную информацию так же ловко, как это делал сам Виет, разгадывая секретный смысл таинственных иностранных символов. Венецианский посол во Франции Джованни Мочениго написал, что однажды он имел следующую беседу с Виетом:

«Он[6](http://www.e-reading.club/bookreader.php/25249/Kan_-_Vzlomshchiki_kodov.html#_edn6)только что сказал мне, что было перехвачено большое количество шифрованных писем испанского короля, а также императора[7](http://www.e-reading.club/bookreader.php/25249/Kan_-_Vzlomshchiki_kodov.html#_edn7)и других государей, которые он дешифровал. Когда я выразил большое изумление, он сказал мне:

– Я представлю вашему правительству веские доказательства этого.

Он немедленно принес мне толстую пачку писем от упомянутых государей, которые он дешифровал, и добавил.

– Я хочу, чтобы вы также знали, что я знаю их шифр.

– Я не поверю этому, – сказал я, – пока не увижу сам.

Поскольку у меня было три моих шифра – обычный, которым я пользовался, второй, который я не применял, и третий под названием «dalle caselle»[8](http://www.e-reading.club/bookreader.php/25249/Kan_-_Vzlomshchiki_kodov.html#_edn8), он раскрыл мне, что знает первый шифр. Затем, чтобы лучше разобраться в таком серьезном деле, я сказал ему:

– Вы, несомненно, знаете наш шифр «dalle caselle»?

– Чтобы его узнать, нужно изрядно попрыгать, – ответил он, подразумевая под этим, что ему известны только части шифра.

Я попросил его показать мне несколько наших дешифрованных писем. Он обещал мне, но затем больше не разговаривал на эту тему, а после того как он ушел, я уже ни разу не встречал его».

Мочениго доложил о разговоре с Виетом в Венецию, и вскоре по приказу из Венеции все действующие венецианские шифры были заменены.

Между тем из перехваченных им французских писем Филипп узнал, что Виет вскрыл шифр, который в Испании считался неуязвимым. Это рассердило Филиппа. Решив причинить хлопоты французам безо всякого ущерба для себя, он сообщил Папе, что Генрих вскрыл папские шифры с помощью черной магии, и попросил сурово наказать его за колдовство. Но такая тактика причинила ущерб престижу самого Филиппа. Папа, доверяя своим криптографам и зная от них о ненадежности испанских шифров, ничего не предпринял в отношении просьбы короля Испании. Сам же Филипп был осмеян всеми, кто прослышал об этой истории.

Одним из тех, кто, должно быть, смеялся больше всех, был фламандский дворянин Филипп ван Марникс, барон де Сент-Альдегонд, правая рука Вильгельма Оранского, стоявшего во главе объединенного восстания голландцев и фламандцев против Испании. Марникс, автор мелодии современного национального гимна Голландии, был также блестящим криптоаналитиком и только что закончил работу по вскрытию испанского шифра. Шифрованное письмо испанцев, прочитанное Марниксом, было перехвачено Генрихом IV во время осады Парижа. Отправителем письма был опять неудачливый Морео, а его адресатом – снова король Филипп.

Французский король лично передал эту испанскую криптограмму своему фламандскому союзнику-протестанту. Прочитав ее, Марникс обнаружил в ней оскорбительные выпады против герцога Пармы, который был также испанским губернатором Голландии. В августе 1590 г. Генрих повелел Марниксу отправить герцогу Пармы как саму криптограмму Морео, так и ее открытый текст, надеясь тем самым раздуть разногласия между ними. Однако герцог посчитал ниже своего достоинства отвечать на клеветнические выпады испанского военачальника и не предпринял никаких ожидавшихся Генрихом действий против Морео.

Это был не первый случай вскрытия Марниксом испанских шифров: за 13 лет до этого он добился результата, который привел в действие цепь событий, завершившихся на плахе палача.

В 1577 г. Голландией правил испанский губернатор дон Хуан Австрийский, единокровный брат короля Филиппа. Честолюбивые замыслы дона Хуана не ограничивались крошечной Голландией. Он мечтал пересечь пролив Ла-Манш, высадиться с войсками в Англии, свергнуть королеву Елизавету, а затем жениться на обольстительной королеве Шотландии Марии и вместе с ней носить английскую корону. Филипп дал брату согласие на вторжение и на женитьбу. Правда, и то и другое должно было произойти лишь после того, как дон Хуан восстановит мир и спокойствие в Голландии.

Но Англия не дремала. Через своих шпионов на Европейском континенте министр Елизаветы Фрэнсис Уолсингем пронюхал о том, что против Англии замышляется что-то недоброе. Его подозрения оставались неподтвержденными до тех пор, пока в июне 1577 г. во Франции не были перехвачены несколько шифрованных писем дона Хуана. Письма были переправлены Марниксу, который через месяц вскрыл испанский шифр, использованный для их зашифрования. Особенность этого шифра заключалась в том, что каждая гласная открытого текста помимо буквенной и цифровой замен имела еще одно обозначение в виде завитушки. Если в открытом тексте согласная предшествовала гласной, то эту завитушку писали вместе с шифрованным знаком согласной, так что получался комбинированный символ, представлявший обе эти буквы.

11 июля Вильгельм Оранский сообщил содержание писем дона Хуана, дешифрованных Марниксом, Даниэлю Роджерсу, одному из агентов Уолсингема. Роджерс так написал об этом в своем докладе Уолсингему:

«Принц[9](http://www.e-reading.club/bookreader.php/25249/Kan_-_Vzlomshchiki_kodov.html#_edn9)сказал мне, что ее величество может понять, как было достигнуто соглашение между доном Хуаном и папским нунцием, если она ознакомится с письмами, написанными доном Хуаном и Эсковедо[10](http://www.e-reading.club/bookreader.php/25249/Kan_-_Vzlomshchiki_kodov.html#_edn10)в апреле прошлого года и перехваченными теперь. Затем он вызвал г-на де Сент-Альдегонда и поручил ему принести письма… Сент-Альдегонд принес девять писем. Все они были написаны по-испански. Большая часть каждого письма, за исключением одного, была зашифрована. Три письма были написаны доном Хуаном, причем два были адресованы королю[11](http://www.e-reading.club/bookreader.php/25249/Kan_-_Vzlomshchiki_kodov.html#_edn11), а одно – министру короля Антонио Пересу. Автором остальных писем был Эсковедо, и они предназначались королю. Принц также показал мне письмо ла Ну[12](http://www.e-reading.club/bookreader.php/25249/Kan_-_Vzlomshchiki_kodov.html#_edn12), в которое были вложены все вышеупомянутые письма, так как последний перехватил их во Франции. Я счел нужным сделать некоторые выписки по главным темам, содержавшимся в них».

Уолсингем, несомненно, был прельщен возможностями, открывшимися перед ним, когда через Роджерса он ознакомился с результатами работы Марникса по дешифрованию испанской корреспонденции. Поэтому он незамедлительно принял меры, чтобы обеспечить себе больший приток информации и при этом не зависеть от иностранных криптоаналитиков. С этой целью он направил в Париж одного талантливого юношу, который очень ловко расправлялся с шифрованными депешами. Это был Томас Фелиппес, первый знаменитый криптоаналитик из Англии.

В качестве курьера Уолсингема Фелиппес много путешествовал по Франции. По возвращении он стал одним из наиболее доверенных помощников Уолсингема. Фелиппес одинаково умело дешифровывал переписку на латинском, французском, итальянском и испанском языках. Единственное описание его внешности вышло из-под пера королевы Шотландии Марии Стюарт. Согласно ей, Фелиппес – блондин со светлой бородой, «низкого роста, весьма стройный, лицо изрыто оспинками, близорук, на вид ему можно дать 30 лет».

Эти нелестные замечания Марии выдают ее подозрения в отношении Фелиппеса – подозрения, которые не были безосновательными, ибо Фелиппес и его хозяин Уолсингем пристально следили за Марией по причинам, которые, в свою очередь, в равной мере являлись оправданными. Мария была бесспорной наследницей английского трона. Номинально она считалась также королевой Шотландии, хотя и была оттуда изгнана. Это была выдающаяся женщина: красивая, обладавшая даром большого личного обаяния, умевшая внушать преданность своим подданным, храбрая католичка, непоколебимо преданная своей религии, но вместе с тем неблагоразумная, упрямая, капризная. Различные католические группировки не раз замышляли возвести ее на английский трон и таким образом восстановить господство римской Церкви. Многие годы Мария прожила пленницей в английских замках, и все это время Уолсингем настойчиво искал возможность раз и навсегда покончить со смертельной угрозой, которую для королевы Елизаветы представляла Мария.

Такая возможность представилась в 1586 г. Бывший паж Марии Энтони Бабингтон приступил к подготовке заговора. Вовлеченные в заговор придворные должны были убить Елизавету, организовать широкое восстание католиков в Англии и короновать Марию. Бабингтон также заручился поддержкой Филиппа II, который обещал прислать войска на помощь, как только Елизавета будет мертва. Чтобы получить согласие Марии, Бабингтон был вынужден вступить с ней в переписку.

Эта задача была не из легких. Мария была отрезана от внешнего мира и находилась под домашним арестом в загородном поместье. Один бывший семинарист по имени Гилберт Гиффорд, которого Бабингтон завербовал в качестве посыльного, придумал способ тайной доставки корреспонденции Марии в бочонке с пивом.

В основном эта корреспонденция посылалась в зашифрованном виде. Зашифровывал письма Марии один из ее двух доверенных секретарей. Мария часто отдавала им распоряжения о внесении изменений в используемые номенклаторы для повышения их стойкости. Кроме того, чтобы обеспечить безопасность своей переписки, Мария настояла на том, чтобы все письма сочинялись в ее апартаментах, зачитывались ей перед зашифрованием и опечатывались в ее присутствии.

Но ни Мария, ни Бабингтон не знали того, что, несмотря на тщательно разработанные меры предосторожности, их письма сразу же после написания доставлялись прямо Фелиппесу. Гилберт Гиффорд был двойным агентом и работал не только на Бабингтона, но и на Уолсингема. Шифрованные послания Марии читались Фелиппесом почти сразу же после того, как он их получал.

Уолсингем умышленно не препятствовал дальнейшему развитию заговора и прохождению тайной корреспонденции, надеясь на то, что Мария окажется замешанной в государственном преступлении. Его ожидания полностью оправдались. В начале июля Бабингтон в своем письме к Марии упомянул о планируемом вторжении испанцев, ее собственном скором освобождении и «казни соперницы, незаконно захватившей власть». Мария думала над ответом в течение недели. После тщательного составления ответа она поручила секретарю зашифровать его. Письмо было отправлено Бабингтону 17 июня. Оно оказалось роковым, поскольку в нем Мария подтверждала существование заговора и давала советы Бабингтону о способах «его успешного доведения до конца». Как только Фелиппес дешифровал письмо, он сразу же расценил его как смертный приговор Марии.

Но Уолсингем все еще не знал имен шести молодых придворных, которые должны были совершить убийство Елизаветы. Поэтому, когда письмо Марии попало к Бабингтону и тот его расшифровал, в конце письма была приписка, содержавшая просьбу сообщить имена «тех шести джентльменов, которые должны осуществить план». Автором подделки был Фелиппес.

Хитроумная затея Фелиппеса оказалась лишней. По предложению Уолсингема Бабингтону, как бы случайно, показали записку с требованием его ареста. Бабингтон спешно бежал, чтобы спасти себе жизнь. Узнав о его побеге, скрылись и шестеро молодых джентльменов, о которых шла речь. В течение месяца и они, и Бабингтон были пойманы. Суд приговорил их к смертной казни. Перед казнью Бабингтона заставили выдать шифр, которым он пользовался в переписке с Марией.

Этот шифр и письма Марии послужили главным обвинительным материалом на заседаниях суда, который признал Марию виновной в государственной измене. С величавым спокойствием встретила Мария объявление о том, что Елизавета подписала ей смертный приговор. 8 февраля 1587 г. в 8 часов утра она, еще раз проникновенно заявив о своей невиновности и помолившись вслух о благополучии своей Церкви и сына, с гордо поднятой головой взошла на эшафот, встала на колени и мужественно приняла от палача три удара топором. Так окончилась короткая жизнь Марии, королевы Шотландии, насильственную смерть которой ускорил криптоанализ.

